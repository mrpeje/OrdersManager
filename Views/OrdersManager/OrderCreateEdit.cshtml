@{
    ViewData["Title"] = "Order item Create/Edit page";
    var headers = new List<(string propertyName, string colName)> { ("Name", "Имя"), ("Quantity", "Количество"), ("Unit", "Секция") };

    var item = new OrderItemModel();
    if(Model.Order == null)
    {
        Model.Order  = new OrderModel();
        Model.Order.Date = DateTime.Today;
    }

    if(Model.OrderItems == null)
        Model.OrderItems  = new List<OrderItemModel>();
    
    Model.NewOrderItem = new OrderItemModel();
    Model.NewOrderItem.Order = Model.Order;

    var partialView = await Component.InvokeAsync("DataTransferView", Model);    
        
}
<h1>@ViewData["Title"]</h1>
@model EditCreatePageModel
@using HtmlHelper
@using Microsoft.AspNetCore.Html


<div>
    </div>
    @using(Html.BeginForm("ProcessFormOrderCreateEdit", "OrdersManager", FormMethod.Post))
    {
        @Html.EditorFor(m => Model.Order)
        @Html.ValidationMessageFor(x => Model.Order)
        <p><input name="SaveOrder" type="submit" value="Сохранить заказ" class="save-button" /></p>

        @Html.EditorFor(m => Model.NewOrderItem)
        @for (int i = 0; i < Model.OrderItems.Count; i++)
        {
            @Html.HiddenFor((m => Model.OrderItems[i].id))
            @Html.HiddenFor((m => Model.OrderItems[i].OrderId)) 
            @Html.HiddenFor((m => Model.OrderItems[i].Name)) 
            @Html.HiddenFor((m => Model.OrderItems[i].Quantity)) 
            @Html.HiddenFor((m => Model.OrderItems[i].Unit)) 
        }
        @Html.ValidationMessageFor(x => Model.NewOrderItem)
        <p><input name="AddOrderItem" type="submit" value="Добавить предмет в заказ" class="add-button"/></p>
    }


@ListHelper.Table(Html, Model.OrderItems, headers, partialView) 